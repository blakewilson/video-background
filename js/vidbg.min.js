/**
 * Video Background
 * Copyright 2017 Push Labs
 * @preserve
 */
!function($){$.vidbg=function(o,e){function i(o){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;o=o.replace(e,function(o,e,i,t){return e+e+i+i+t+t});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}var t=this;t.$el=$(o),t.el=o,t.$el.data("vidbg",t),t.init=function(){t.options=$.extend({},$.vidbg.defaultOptions,e),t.container(),t.displayPoster(),t.selfHostVideo(),t.overlay()},t.isMobile=function(){return!!navigator.userAgent.match(/(Android|iPod|iPhone|iPad|BlackBerry|IEMobile|Opera Mini)/)},t.container=function(){var o=t.$container=$('<div class="vidbg-container">');"static"===t.$el.css("position")&&t.$el.css("position","relative"),t.$el.css("z-index","1"),$(t.$el).prepend(o),t.$el.is("body")&&o.css({position:"fixed"})},t.overlay=function(){var o=t.$container,e=t.$overlay=$('<div class="vidbg-overlay">');!0===t.options.overlay&&e.css({background:"rgba("+i(t.options.overlayColor).r+", "+i(t.options.overlayColor).g+", "+i(t.options.overlayColor).b+", "+t.options.overlayAlpha+")"}),o.append(e)},t.displayPoster=function(o){var e=t.$container;"#"!==t.options.poster&&(!0===o&&e.css("background-image","url("+t.options.poster+")"),!0===t.isMobile()?e.css("background-image","url("+t.options.poster+")"):"#"===t.options.mp4&&"#"===t.options.webm&&e.css("background-image","url("+t.options.poster+")"))},t.selfHostVideo=function(){if(!0!==t.isMobile()&&("#"!==t.options.mp4||"#"!==t.options.webm)){var o=t.$container,e=t.$selfHostVideo=$('<video playsinline><source src="'+t.options.mp4+'" type="video/mp4"><source src="'+t.options.webm+'" type="video/webm"></video>');try{e.prop({autoplay:!0,loop:t.options.repeat,volume:1,muted:t.options.mute,defaultMuted:t.options.mute,playbackRate:1,defaultPlaybackRate:1})}catch(o){console.log("error")}var i=e.get(0).play();void 0!==i&&i.then(function(){console.log("Autoplay started, play promise succeeded")}).catch(function(o){console.log("Autoplay failed, play promise failed (due to audio being enabled)"),t.displayPoster(!0)}),e.one("canplaythrough.vidbg",function(){t.resize()}),e.one("playing.vidbg",function(){e.css({opacity:1})}),o.append(e)}},t.resize=function(){if(!0!==t.isMobile()&&("#"!==t.options.mp4||"#"!==t.options.webm)){var o=t.$container,e=o.outerHeight(),i=o.outerWidth(),n;n=t.$selfHostVideo;var a,s;a=n[0].videoHeight,s=n[0].videoWidth,i/s>e/a?n.css({width:i+2,height:"auto"}):n.css({width:"auto",height:e+2})}},t.init()},$.vidbg.defaultOptions={mp4:"#",webm:"#",poster:"#",mute:!0,repeat:!0,overlay:!1,overlayColor:"#000",overlayAlpha:"0.3",hoverToUnmute:!1,hoverToUnmuteText:"Hover to unmute"},$.fn.vidbg=function(o){return this.each(function(){var e=new $.vidbg(this,o);$(this).data("vidbg",e),$(window).resize(function(){e.resize()})})}}(jQuery);
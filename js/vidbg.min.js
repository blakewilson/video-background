/**
 * Video Background
 * Copyright 2017 Push Labs
 * @preserve
 */
!function($){$.vidbg=function(o,e){function i(o){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;o=o.replace(e,function(o,e,i,n){return e+e+i+i+n+n});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}var n=this;n.$el=$(o),n.el=o,n.$el.data("vidbg",n),n.init=function(){n.options=$.extend({},$.vidbg.defaultOptions,e),n.container(),n.displayPoster(),n.selfHostVideo(),n.overlay()},n.isMobile=function(){return!!navigator.userAgent.match(/(Android|iPod|iPhone|iPad|BlackBerry|IEMobile|Opera Mini)/)},n.container=function(){var o=n.$container=$('<div class="vidbg-container">');"static"===n.$el.css("position")&&n.$el.css("position","relative"),n.$el.css("z-index","1"),$(n.$el).prepend(o),n.$el.is("body")&&o.css({position:"fixed"})},n.overlay=function(){var o=n.$container,e=n.$overlay=$('<div class="vidbg-overlay">');!0===n.options.overlay&&e.css({background:"rgba("+i(n.options.overlayColor).r+", "+i(n.options.overlayColor).g+", "+i(n.options.overlayColor).b+", "+n.options.overlayAlpha+")"}),o.append(e)},n.displayPoster=function(o){var e=n.$container;"#"!==n.options.poster&&(!0===o&&e.css("background-image","url("+n.options.poster+")"),!0===n.isMobile()?e.css("background-image","url("+n.options.poster+")"):"#"===n.options.mp4&&"#"===n.options.webm&&e.css("background-image","url("+n.options.poster+")"))},n.selfHostVideo=function(){if(!0!==n.isMobile()&&("#"!==n.options.mp4||"#"!==n.options.webm)){var o=n.$container,e=n.$selfHostVideo=$('<video playsinline><source src="'+n.options.mp4+'" type="video/mp4"><source src="'+n.options.webm+'" type="video/webm"></video>');try{e.prop({autoplay:!0,loop:n.options.repeat,volume:1,muted:n.options.mute,defaultMuted:n.options.mute,playbackRate:1,defaultPlaybackRate:1})}catch(o){console.log("error")}var i=e.get(0).play();void 0!==i&&i.then(function(){console.log("Autoplay started, play promise succeeded")}).catch(function(o){console.log("Autoplay failed, play promise failed (due to audio being enabled)"),n.displayPoster(!0)}),e.one("canplaythrough.vidbg",function(){n.resize()}),e.one("playing.vidbg",function(){e.css({opacity:1})}),o.append(e)}},n.resize=function(){if(!0!==n.isMobile()&&("#"!==n.options.mp4||"#"!==n.options.webm)){var o=n.$container,e=o.outerHeight(),i=o.outerWidth(),t;t=n.$selfHostVideo;var a,s;a=t[0].videoHeight,s=t[0].videoWidth,i/s>e/a?t.css({width:i+2,height:"auto"}):t.css({width:"auto",height:e+2})}},n.init()},$.vidbg.defaultOptions={mp4:"#",webm:"#",poster:"#",mute:!0,repeat:!0,overlay:!1,overlayColor:"#000",overlayAlpha:"0.3"},$.vidbg.instanceCollection={instance:[]},$.fn.vidbg=function(o){return this.each(function(){var e=$.data(this,"vidbg");e=new $.vidbg(this,o),e.index=$.vidbg.instanceCollection.instance.push(e)-1,$.data(this,"vidbg",e)})},$(document).ready(function(){$(window).on("resize.vidbg",function(){for(var o=$.vidbg.instanceCollection.instance.length,e=0,i;e<o;e++)(i=$.vidbg.instanceCollection.instance[e])&&i.resize()})})}(jQuery);